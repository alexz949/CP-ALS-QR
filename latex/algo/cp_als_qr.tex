\begin{algorithmic}[1]
    \Function{$[\bm{\lambda},\M{A}_{n}]=$ CP-ALS}{$\T{X},R$}
      \State Setup factor matirces  $\mat{A}_1$, $\mat{A}_2$, $\dots$, $\mat{A}_n$
      \State Compute QR decomposition for factor matrices $\mat{Q}_N\mat{R}_N, \dots \mat{Q}_1\mat{R}_1$
      \While{not converge}
      \For{$n = 1, \dots, N$}
      \State Compute QR factorization $\mat{Q}_0\mat{R}_0$ for Khatri-Rao product of $\mat{R}_N, \dots, \mat{R}_1$
      \State TTM for $\mat{Y}_{(n)} =  \T{X} \times_1 \mat{Q}_1^\top \dots \times_{n-1} \mat{Q}_{n-1}^\top \times_{n+1} \mat{Q}_{n+1}^\top \dots \times_N \mat{Q}_N^\top$
      \State Solve $\mat{\hat{A}_n} = \mat{R}_0^\top \text{\textbackslash} \mat{Y}_{(n)} \mat{Q}_0$
      \State Update $\mat{A}_n$ and $\bm{\lambda}$
      \State Update QR for $\mat{A}_n = \mat{Q}_n\mat{R}_n$      
      \EndFor
      \EndWhile
    \EndFunction
  \end{algorithmic}